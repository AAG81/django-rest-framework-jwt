[tox]
minversion = 3.5
envlist =
    {py27,py33,py34,py35,py36}-dj{18,19,110,111}-drf{31,32,33,34,35,36}

[testenv]
description = run the test suite
usedevelop = true
setenv =
    PYTHONDONTWRITEBYTECODE=1
deps =
    dj18: Django<1.9
    dj19: Django<1.10
    dj110: Django<1.11
    dj111: Django<1.12
    drf31: djangorestframework<3.2
    drf32: djangorestframework<3.3
    drf33: djangorestframework<3.4
    drf34: djangorestframework<3.5
    drf35: djangorestframework<3.6
    drf36: djangorestframework<3.7
    py27-dj{18,19}-drf{31,32,33,34}: djangorestframework-oauth==1.0.1
    coverage: coverage
    codecov: codecov
commands =
    pytest {posargs}
extras =
    test

[testenv:docs]
description = build the documentation
commands = mkdocs build
extras =
    test
    docs

[testenv:changelog]
description = build the changelog
basepython = python3
deps =
    towncrier==18.6.0
skip_install = true
commands =
    python -V
    towncrier {posargs}

[testenv:make-release]
description = build the changelog, bump the package version, commit and tag
basepython=python2.7
skip_install = true
whitelist_externals = git
passenv =
    HOME
deps =
    bumpversion==0.5.3
commands_pre =
    tox -e changelog -- --yes
    git commit -m "Build changelog"
    bumpversion {posargs:minor}
commands =
    git push origin
    git push origin --tags
